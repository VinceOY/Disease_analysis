disease analysis:

step1: target: 三院檢驗結果合併檔csv
step1.1: 兩院結果合併、select column, rename
step1.2: 萬芳結果select column, rename
step1.3: 雙和、北醫、萬芳結果合併
output_column: ID, Test_Date, Test_ID, value

step2: taget: Hba1c 檢驗報告
step2.1: 從lab_result挑選出目標疾病
step2.2: 輸出output

step3: 清理目標疾病 
step3.1: 將欄位拆分
step3.2: <>定義成outliers
step3.3: drop NA values / outliers
output: HbA1c檢驗項目(value 欄位分成 numeric value 和 unit) 以及drop NA values / outliers

step4: 
step4.1: merge with (糖尿病患者 in  outcome) 
step4.2: clean na ID (無相關檢驗報告的患者)
output: dt_diabete: 糖尿病患者withoutcome 含test item檢驗值

step5: find 有效患者
step5.1: 篩選need cols("ID", "Index_date", "Test_date")

step6: 全體有效患者的 mean, median, sd by id, season 

step7: create tables: table1, table2, table3

Table1: 
所有糖尿病患者的基本資料摘要(AGE、Year、SEX_TYPE、AGE_GROUP、11種control disease)
Table2: 
index date一年內4季皆有定期檢驗test_item的糖尿病患者中test_item檢驗值的(各季(median, n), 總次數) 
Table3: (TODO)
目標病患在各檢驗項目下對應到各outcome數量以及總追蹤時間
cols = c(# of outcome, sum of followups, N)







TODO:
exclude 修改(not done )
outlier detect:
檢驗次數 < 3 次 by paper (不會有這個問題)
ADD 單位欄位 done 
ADD: 檢測的 follow up date確認檢測資料分布情況 done 
summary: . 檢驗日比確診日前面的資料的處理方式(不會有這個問題)
table4 col: (# of events, sum of follow ups, total N)
interval 流程修改
mean, sd , rms, CV
新發人數分布
model result(Cox model)
流程圖: 包括輸出斷點
 























1. 關鍵字網路爬蟲: 有把結果整理給怡諄再提供給資拓看後續需要什麼幫助

2. 中風資料分析: 
目前是找一篇糖尿病相關論文去進行實作




[參考文獻：Predictions of diabetes complications and mortality using hba1c variability: a 10-year observational cohort study]


研究目的 : 各項併發症的變異程度(穩定性), ex : hba1c 對糖尿病的影響
 

資料區間 : 

目標病患 : 三院糖尿病患者


x1: 單一檢測項目在確診後一年的數值標準差(確認是否有類別變數)
x2: 其他disease codes1在追蹤期間是否發病(1,0)
x3: 其他disease codes2在追蹤期間是否發病(1,0)
...
xn: 其他disease codes3在追蹤期間是否發病(1,0)

yt: [(1,0), t]

其他:
401 (Essential hypertension), 
726 (Peripheral enthesopathies and allied syndromes), 
799 (Other ill-defined and unknown causes of morbidity and mortality), 
272 (Disorders of lipoid metabolism),
465 (Acute upper respiratory infections of multiple or unspecified sites), 
724 (Other and unspecified disorders of back), 
789 (Other symptoms involving abdomen and pelvis), 
110 (Dermatophytosis), 
780 (General symptoms), 
786 (Symptoms involving respiratory system and other chest symptoms), 
784 (Symptoms involving head and neck), 
692 (Contact dermatitis and other eczema), 
79 (Viral infection in conditions classified elsewhere and of unspecified site), 
278 (Overweight, obesity and other hyperalimentation), 
719 (Other and unspecified disorders of joint), 
466 (Acute bronchitis and bronchiolitis), 
729 (Other disorders of soft tissues), 
790 (Nonspecific findings on examination of blood), 
367 (Disorders of refraction and accommodation), 
372 (Disorders of conjunctiva)

Mathching: 因為目前資料中只有ICD10欄位對ICD9的資料須做轉換
參考table: 4.1 ICD-9-CM2001年版與ICD-10-CM對應資料檔(106.07.19更新)

ICD9: 數字編碼
ICD10: 英文開頭

糖尿病相關:
ICD10 = "E08","E09","E10","E11","E12"
ICD9 = 
Eye complications
362.01 
362.02
362.55
362.11
365.44
369
361
369.60

Cardiovascular disease:
414.9
413.9
411.1
412
428
425
402

Cerebrovascular disease
435.9
434.91
432.9
432.9
437.1

Peripheral vascular disease
440.2
440.20
440.21
440.22
440.23
440.24

Nephropathy
583
585
V451

Diabetic neuropathy
357.2     
337.1     
353       


Matching: 疾病資料 => (病人資料, 檢驗結果 => 檢驗名稱)

疾病資料相關資料表: OPD_BASIC、IPD_BASIC
=====================================================================
OPD_BASIC:
相關欄位: "CHR_NO"、"OPD_DATE"、"ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", 
          "ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", 
	  "ICD10_CODE5"
Merge with 不同就診類型(醫院、門診): "CHR_NO"+"IPD_DATE"
Merge with 病人資料: CHR_NO
Merge with 檢驗結果: CHR_NO

IPD_BASIC
相關欄位: "CHR_NO"、"IPD_DATE"、"ICD10_CODE1", "ICD10_CODE2", 
	  "ICD10_CODE3","ICD10_CODE4", "ICD10_CODE5", "ICD10_CODE6", 
          "ICD10_CODE7"
Merge with 不同就診類型(醫院、門診): "CHR_NO"+"IPD_DATE"
Merge with 病人資料: CHR_NO
Merge with 檢驗結果: CHR_NO

病人資料:
=====================================================================
相關資料表: CHR_BASIC
相關欄位: "CHR_NO","SEX_TYPE","BIRTH_DATE"
Merge with 疾病資料: CHR_NO


檢驗結果:
=====================================================================
相關資料表: LABRESULT
至少要有CHR_NO、DATE、TEST_ITEM、VALUE
相關欄位:"CHR_NO"、"B_DATE"、"ITEM_NO","ITEM_NAME","ITEM_CNAME", 
Merge with 疾病資料 cols: CHR_NO
Note: "P_DATE"可能是開單日 過段時間才會去做檢驗


檢驗名稱相關資料表: EXPERIMENT、EXP_ITEM
=====================================================================
EXP_ITEM:
相關欄位:"R_ITEM"、"R_ITEM_NAME"
Merge with 檢驗結果: R_ITEM


EXPERIMENT:
相關欄位:"ITEM_NO","ITEM_NAME","ITEM_CNAME"
Merge col: ITEM_NO


#================================
Todo: 
1. function1 output 修改
2. 文件&流程
3. 檢驗名稱用unique去做比對 => check other hba1c
4. standard date修改
5. 對時間區間的定義
6. 抓出其他病










1. result 自動化
step1:	data summary
step2:	data preprocess
step3: 	data summary
step4: 	data pair
step5: 	data analysis
step5.1:	baseline analysis
step5.2:	K-M curve
step5.3:	Cox model



ID: 130507

簽到時間


1. 網路爬蟲: 針對所屬單位業務需求撈取關鍵字
來源: 資拓
討論對象:怡諄、博賢
短期目的: 社工的訪視紀錄資料結構化
長期目的: 建構預測高風險族群的模型
翻譯

2. 中風資料分析: 
目前是找一篇糖尿病相關論文去進行實作

來源: 臨床資料分析
討論對象:博賢
短期目的:撈取各病人確診時間
長期目的:確認疾病間的相關性
整理欄位資料:
col1: 病人ID
col2: 確診時間
col3: 疾病ID

-------------------------------------------
1.電話轉接
2.VPN